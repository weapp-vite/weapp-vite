/* stylelint-disable selector-class-pattern, order/properties-order, property-no-vendor-prefix, rule-empty-line-before, comment-empty-line-before, declaration-empty-line-before */
@use 'sass:color';
@use './vars' as *;

/* Top navigation */
.VPNav {
  backdrop-filter: saturate(160%) blur(10px);
  background: linear-gradient(180deg, color.change(#fff, $alpha: 0.72), color.change(#fff, $alpha: 0.62));
  border-bottom: 1px solid color.change($p2, $alpha: 0.12);
  box-shadow: 0 6px 18px color.change(#000, $alpha: 0.04);
  /* ensure navbar stays above page hero/sections that might create stacking contexts */
  z-index: 50;
}

/* Mobile nav screen: ensure it expands even if theme JS fails to set height var */
@media (max-width: 960px) {
  .VPNavScreen {
    /* use dynamic viewport units to avoid iOS 100vh issues; fallback to 100vh */
    --_vh: 100dvh;
    height: var(--vp-nav-screen-height, calc(var(--_vh) - var(--vp-nav-height, 64px)));
    max-height: var(--vp-nav-screen-height, calc(var(--_vh) - var(--vp-nav-height, 64px)));
    /* keep screen above nav bar */
    z-index: 60;
  }
  /* Fallback for browsers not supporting dvh/svh units */
  @supports not (height: 100dvh) {
    .VPNavScreen {
      height: var(--vp-nav-screen-height, calc(100vh - var(--vp-nav-height, 64px)));
      max-height: var(--vp-nav-screen-height, calc(100vh - var(--vp-nav-height, 64px)));
    }
  }
}
.VPNav .group,
.VPNav .content {
  color: var(--vp-c-text-1);
}
.VPNavBarTitle > .title {
  background: linear-gradient(120deg, #{$p1}, #{$p2});
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  font-weight: 800;
  letter-spacing: 0.2px;
}

/* Tone down nav brand title in light mode */
html:not(.dark) .VPNavBarTitle > .title {
  $dim1: color.mix(#0a0f0a, $p1, 78%);
  $dim2: color.mix(#0a0f0a, $p2, 68%);
  background-image: linear-gradient(120deg, #{$dim1}, #{$dim2});

  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}
.VPNavBarSearch input {
  border-radius: 999px !important;
  background: color.change(#1a231c, $alpha: 0.7);
  border: 1px solid color.change($p2, $alpha: 0.22);
  color: var(--vp-c-text-1);
}
.VPNavBarSearch input:focus {
  box-shadow: 0 0 0 2px color.change($p1, $alpha: 0.45);
}

.VPNavBar .menu {
  gap: 10px;
  padding: 0;
  border-radius: 10px;
  background: transparent;
  border: none;
  box-shadow: none;
}
.VPNavBar .menu :where(.VPNavBarMenuLink) {
  position: relative;
  border-radius: 8px;
  padding: 8px 12px;
  color: var(--vp-c-text-2);
  transition:
    color 150ms ease,
    transform 160ms cubic-bezier(0.22, 1, 0.36, 1),
    background 160ms ease;
  background: transparent;
  border: none;
}
.VPNavBar .menu :where(.VPNavBarMenuLink)::after {
  content: '';
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: 5px;
  height: 2px;
  border-radius: 999px;
  background: linear-gradient(90deg, $p1, $p2);
  transform: scaleX(0);
  transform-origin: 0 50%;
  transition: transform 160ms ease;
  opacity: 0.9;
}
.VPNavBar .menu :where(.VPNavBarMenuLink):hover {
  color: #0a0f0a;
  transform: translateY(-1px);
  background: transparent;
}
.VPNavBar .menu :where(.VPNavBarMenuLink.active, .VPNavBarMenuLink[aria-current='page']) {
  color: #0a0f0a;
  background: transparent;
  border-color: transparent;
}
.VPNavBar .menu :where(.VPNavBarMenuLink.active, .VPNavBarMenuLink[aria-current='page'])::after {
  transform: scaleX(1);
}

/* Dark mode tweaks for nav glass */
html.dark {
  .VPNavBar .menu :where(.VPNavBarMenuLink) {
    background: transparent;
    border-color: color.change($p1, $alpha: 0.12);
    color: var(--vp-c-text-2);
  }
  .VPNavBar .menu :where(.VPNavBarMenuLink):hover {
    color: #eaf6ee;
    background: transparent;
  }
  .VPNavBar .menu :where(.VPNavBarMenuLink.active, .VPNavBarMenuLink[aria-current='page']) {
    color: #eaf6ee;
    background: transparent;
    border-color: color.change($p1, $alpha: 0.3);
  }
}

/* Local outline */
.VPLocalNav {
  border-left: 1px solid color.change($p2, $alpha: 0.18);
}
.VPLocalNav .outline .outline-link {
  position: relative;
}
.VPLocalNav .outline .outline-link:hover {
  color: var(--vp-c-text-1);
}
.VPLocalNav .outline .outline-link.is-active::before {
  content: '';
  position: absolute;
  left: -10px;
  top: 0.6em;
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: linear-gradient(120deg, #{$p1}, #{$p2});
  box-shadow: 0 0 0 2px color.change($p2, $alpha: 0.25);
}
